<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cart - stacyTech</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="mediaqueries.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>
<body>
  <header style="display:flex;justify-content:space-between;align-items:center;padding:1rem 2rem;">
    <a href="index.html" style="color:inherit;text-decoration:none;">‚Üê Back to shop</a>
    <div class="logo">stacyTech</div>
  </header>

  <main style="max-width:1100px;margin:2rem auto;padding:0 1rem;color:rgb(122,121,121);">
    <h1 style="color:white;margin-bottom:1rem;">Your Cart</h1>

    <div id="cart-items"></div>

    <div id="cart-summary" style="margin-top:1.5rem;display:flex;justify-content:space-between;align-items:center;">
      <div id="empty-msg" style="color:rgb(150,150,150)"></div>
      <div style="display:flex;gap:10px;align-items:center">
        <div style="font-weight:600;color:white">Total: <span id="cart-total">$0.00</span></div>
        <button id="clear-cart" style="background:#222;color:#fff;border:none;padding:.5rem 1rem;border-radius:6px;cursor:pointer">Clear</button>
        <button id="to-delivery" style="background:#ff4444;color:#fff;border:none;padding:.5rem 1rem;border-radius:6px;cursor:pointer">Proceed to Delivery</button>
      </div>
    </div>
  </main>

  <script>
  
    function getCart() {
      try { return JSON.parse(localStorage.getItem('cart') || '[]'); }
      catch(e){ return []; }
    }
    function saveCart(cart){ localStorage.setItem('cart', JSON.stringify(cart)); }

    function formatPrice(p){ return '$' + Number(p).toFixed(2); }

    function renderCart() {
      const container = document.getElementById('cart-items');
      const cart = getCart();
      container.innerHTML = '';
      if (!cart.length) {
        document.getElementById('empty-msg').textContent = 'Cart is empty';
        document.getElementById('cart-total').textContent = formatPrice(0);
        return;
      }
      document.getElementById('empty-msg').textContent = '';
      const list = document.createElement('div');
      list.style.display = 'flex';
      list.style.flexDirection = 'column';
      list.style.gap = '1rem';

      let total = 0;
      cart.forEach((item, idx) => {
        const row = document.createElement('div');
        row.style.display = 'flex';
        row.style.justifyContent = 'space-between';
        row.style.alignItems = 'center';
        row.style.background = '#0f0f0f';
        row.style.padding = '0.8rem';
        row.style.borderRadius = '8px';

        const left = document.createElement('div');
        left.style.maxWidth = '70%';
        left.innerHTML = '<div style="font-weight:600;color:#fff">' + item.name + '</div>'
                       + '<div style="color:rgb(150,150,150)">' + (item.price ? formatPrice(item.price) : '') + '</div>';

        const right = document.createElement('div');
        right.style.display = 'flex';
        right.style.gap = '0.6rem';
        right.style.alignItems = 'center';

        const qty = document.createElement('span');
        qty.textContent = '1';
        qty.style.color = 'rgb(150,150,150)';

        const removeBtn = document.createElement('button');
        removeBtn.textContent = 'Remove';
        removeBtn.style.background = '#222';
        removeBtn.style.color = '#fff';
        removeBtn.style.border = 'none';
        removeBtn.style.padding = '.4rem .6rem';
        removeBtn.style.borderRadius = '6px';
        removeBtn.style.cursor = 'pointer';
        removeBtn.onclick = () => {
          cart.splice(idx,1);
          saveCart(cart);
          renderCart();
        
          if (window.opener && window.opener.updateCartCount) window.opener.updateCartCount();
        };

        right.appendChild(qty);
        right.appendChild(removeBtn);

        row.appendChild(left);
        row.appendChild(right);
        list.appendChild(row);

        total += Number(item.price || 0);
      });

      container.appendChild(list);
      document.getElementById('cart-total').textContent = formatPrice(total);
    }

    document.getElementById('clear-cart').addEventListener('click', () => {
      localStorage.removeItem('cart');
      renderCart();
      if (window.opener && window.opener.updateCartCount) window.opener.updateCartCount();
    });

    document.getElementById('to-delivery').addEventListener('click', () => {
      
      location.href = 'delivery.html';
    });

   
    renderCart();
  </script>
</body>
</html>
